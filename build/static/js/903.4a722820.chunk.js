(self.webpackChunkpaymof=self.webpackChunkpaymof||[]).push([[903],{7903:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var o=n(885),r=n(2791),a=n(2120),s=n(8617),l=n(7425),i=n(408),c=n(184),d=function(){var e=(0,r.useState)(""),t=(0,o.Z)(e,2),n=t[0],d=t[1],u=(0,r.useState)([]),p=(0,o.Z)(u,2),h=p[0],f=p[1],m=(0,r.useState)([]),x=(0,o.Z)(m,2),v=x[0],b=x[1],j=(0,r.useState)([]),y=(0,o.Z)(j,2),g=y[0],w=y[1],k=(0,r.useState)(""),C=(0,o.Z)(k,2),S=C[0],_=C[1],T=(0,r.useState)(""),E=(0,o.Z)(T,2),N=E[0],O=E[1],D=(0,r.useState)(""),W=(0,o.Z)(D,2),L=W[0],R=W[1],U=(0,r.useState)("debtors"),Z=(0,o.Z)(U,2),P=Z[0],B=Z[1],I=(0,r.useState)([]),F=(0,o.Z)(I,2),M=F[0],q=F[1],A=(0,r.useState)(!1),G=(0,o.Z)(A,2),H=G[0],J=G[1],Q=(0,r.useState)([]),V=(0,o.Z)(Q,2),X=V[0],Y=V[1],z=(0,r.useState)([]),K=(0,o.Z)(z,2),$=K[0],ee=K[1],te=(0,r.useState)(0),ne=(0,o.Z)(te,2),oe=ne[0],re=ne[1],ae=(0,r.useContext)(s.T),se=ae.url,le=ae.notifications;(0,r.useEffect)((function(){return fetch("".concat(se,"/main/payment/classes"),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(e.status){var t;t=e.message[0];try{b(t.terms.split(",")),w(t.sessions.split(",")),f(JSON.parse(t.classes)),O(t.current_session),R(t.current_term.toUpperCase()),ee(t.payment_for.split(","))}catch(n){le.warning("failed to set datas. Try reloading")}}})).catch((function(e){return console.log(e)})),function(){b([]),w([]),f([])}}),[document.readyState]);return(0,c.jsxs)("div",{className:"__debtors",children:[(0,c.jsx)(a.Notifications,{position:"top-right"}),(0,c.jsx)("h2",{children:"Debtors"}),(0,c.jsxs)("form",{className:"search-container container",children:[(0,c.jsx)("label",{htmlFor:"name",children:"Date"}),(0,c.jsx)("div",{className:"input-filter-cont",children:(0,c.jsx)("input",{type:"date",value:S,onChange:function(e){return _(e.target.value)},required:!0})}),(0,c.jsxs)("select",{value:n,onChange:function(e){return d(e.target.value)},className:"filter-class",required:!0,children:[(0,c.jsx)("option",{value:"",children:"Class"}),h&&h.map((function(e){return(0,c.jsx)("option",{value:e.toUpperCase(),children:e.toUpperCase()},Math.random())}))]}),(0,c.jsxs)("select",{value:L,onChange:function(e){return R(e.target.value)},className:"filter-term",children:[(0,c.jsx)("option",{value:"",children:"Term"}),v&&v.map((function(e){return(0,c.jsx)("option",{value:e.toUpperCase(),children:e.toUpperCase()},Math.random())}))]}),(0,c.jsxs)("select",{value:N,onChange:function(e){return O(e.target.value)},className:"filter-sess",children:[(0,c.jsx)("option",{value:"",children:"Session"}),g&&g.map((function(e){return(0,c.jsx)("option",{value:e.toUpperCase(),children:e.toUpperCase()},Math.random())}))]}),(0,c.jsxs)("select",{value:P,onChange:function(e){return B(e.target.value)},className:"filter-sort",children:[(0,c.jsx)("option",{value:"debtors",children:"DEBTORS"}),(0,c.jsx)("option",{value:"cleared",children:"CLEARED"}),(0,c.jsx)("option",{value:"all",children:"ALL"}),$&&$.map((function(e){return(0,c.jsx)("option",{value:e.toUpperCase(),children:e.toUpperCase()},Math.random())}))]}),(0,c.jsx)("div",{className:"btn-cont",children:(0,c.jsxs)("button",{onClick:function(e){return function(e){e.preventDefault(),""!==S&&""!==n&&""!==L&&""!==N&&""!==P?(J(!0),fetch("".concat(se,"/main/records/debtors"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({filteredDate:S,filteredClass:n.toLowerCase(),filteredSess:N,filteredTerm:L.toLowerCase(),sort:P.toLowerCase()})}).then((function(e){return e.json()})).then((function(e){J(!1),e.status?(q(e.message),Y(e.totalArr),re(0)):le.warning(e.message)})).catch((function(e){J(!1),console.log(e)}))):le.warning("Enter the necessaey fields")}(e)},className:"btn btn-success btn-sm",children:[(0,c.jsx)(l.Qcu,{}),(0,c.jsx)("span",{style:{marginLeft:".3rem"},children:"Find"})]})})]}),(0,c.jsx)("div",{className:"debtors-table",children:0!==M.length&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("table",{className:"table table-responsive table-bordered",id:"table-to-xls",children:[(0,c.jsx)("thead",{className:"thead-dark",children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{children:"Name"}),(0,c.jsx)("th",{children:"Id"}),(0,c.jsx)("th",{children:"Class"}),(0,c.jsx)("th",{children:"Total paid"}),(0,c.jsx)("th",{children:"Balance"}),(0,c.jsx)("th",{children:"Total Fee"}),(0,c.jsx)("th",{children:"DOG"}),(0,c.jsx)("th",{children:"DOB"})]})}),(0,c.jsxs)("tbody",{children:[H?(0,c.jsx)("tr",{className:"loading",children:(0,c.jsx)("td",{colSpan:8,children:"loading..."})}):0===M.length?(0,c.jsx)("tr",{className:"loading",children:(0,c.jsx)("td",{colSpan:8,style:{textAlign:"center"},children:"No debtors available yet!"})}):M.map((function(e,t){var n,o,r,a,s,l,i;return(0,c.jsxs)("tr",{title:null===e||void 0===e?void 0:e.remark,className:null!==e&&void 0!==e&&e.expected_payment&&"0"===(null===e||void 0===e?void 0:e.balance)?"":"alert alert-danger",children:[(0,c.jsxs)("td",{children:[null===e||void 0===e||null===(n=e.name)||void 0===n?void 0:n.toUpperCase()," ",(0,c.jsx)("small",{children:(null===e||void 0===e?void 0:e.expected_payment)&&(0,c.jsxs)("b",{children:["(",null===(o=X[t])||void 0===o?void 0:o.total,")"]})})," "]}),(0,c.jsxs)("td",{children:[null===e||void 0===e?void 0:e.payment_id," "]}),(0,c.jsxs)("td",{children:[null===e||void 0===e||null===(r=e.class)||void 0===r?void 0:r.toUpperCase()," "]}),(0,c.jsxs)("td",{children:[e.expected_payment&&((null===e||void 0===e?void 0:e.expected_payment)-(null===e||void 0===e?void 0:e.balance)).toLocaleString()," "]}),(0,c.jsxs)("td",{children:[null!==(a=null===e||void 0===e||null===(s=e.balance)||void 0===s?void 0:s.toLocaleString())&&void 0!==a?a:""," "]}),(0,c.jsxs)("td",{children:[null!==(l=null===e||void 0===e||null===(i=e.expected_payment)||void 0===i?void 0:i.toLocaleString())&&void 0!==l?l:""," "]}),(0,c.jsxs)("td",{children:[null===e||void 0===e?void 0:e.DOP," "]}),(0,c.jsxs)("td",{children:[" ",(null===e||void 0===e?void 0:e.balance)>0&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{children:(null===e||void 0===e?void 0:e.balance_date)||"No Date"})," ",(0,c.jsx)("span",{children:new Date(null===e||void 0===e?void 0:e.balance_date)<new Date(Date.now())&&"(Expired)"})]})," "]})]},e.keyid+new Date+Math.random())})),(0,c.jsxs)("tr",{colSpan:8,children:[(0,c.jsxs)("td",{onClick:function(){return function(){var e=0;M.map((function(e){return(null===e||void 0===e?void 0:e.expected_payment)&&e})).filter((function(e){return"object"===typeof e})).map((function(t){var n=parseInt(null===t||void 0===t?void 0:t.expected_payment)-parseInt(null===t||void 0===t?void 0:t.balance);return e+=n})),re(e)}()},style:{fontWeight:"bold",cursor:"pointer"},title:"click for total",children:["Total:"," "]}),(0,c.jsxs)("td",{colSpan:7,children:["\u20a6",(0,c.jsx)("span",{children:oe&&oe.toLocaleString()})]})]})]})]}),(0,c.jsx)("div",{className:"container",children:(0,c.jsx)(i.Z,{id:"xls-button",className:"xls-button btn btn-dark btn-sm",table:"table-to-xls",filename:n.replace(/ /g,"_")+"_"+new Date(S).toLocaleDateString().replace(/ /g,"_")+"_"+new Date(Date.now()).toLocaleTimeString().replace(/ /g,"_"),sheet:"tablexls",buttonText:"Download XLS"})})]})})]})}},888:function(e,t,n){"use strict";var o=n(9047);function r(){}function a(){}a.resetWarningCache=r,e.exports=function(){function e(e,t,n,r,a,s){if(s!==o){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:r};return n.PropTypes=n,n}},2007:function(e,t,n){e.exports=n(888)()},9047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},408:function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(2791),a=l(r),s=l(n(2007));function l(e){return e&&e.__esModule?e:{default:e}}var i={table:s.default.string.isRequired,filename:s.default.string.isRequired,sheet:s.default.string.isRequired,id:s.default.string,className:s.default.string,buttonText:s.default.string},c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleDownload=n.handleDownload.bind(n),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"handleDownload",value:function(){if(!document)return null;if(1!==document.getElementById(this.props.table).nodeType||"TABLE"!==document.getElementById(this.props.table).nodeName)return null;var e=document.getElementById(this.props.table).outerHTML,n=String(this.props.sheet),o=String(this.props.filename)+".xls",r={worksheet:n||"Worksheet",table:e};if(window.navigator.msSaveOrOpenBlob){var a=new Blob(['<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>'+e+"</body></html>"]);return document.getElementById("react-html-table-to-excel").click()((function(){window.navigator.msSaveOrOpenBlob(a,o)})),!0}var s=window.document.createElement("a");return s.href="data:application/vnd.ms-excel;base64,"+t.base64(t.format('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta charset="UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>{table}</body></html>',r)),s.download=o,document.body.appendChild(s),s.click(),document.body.removeChild(s),!0}},{key:"render",value:function(){return a.default.createElement("button",{id:this.props.id,className:this.props.className,type:"button",onClick:this.handleDownload},this.props.buttonText)}}],[{key:"base64",value:function(e){return window.btoa(unescape(encodeURIComponent(e)))}},{key:"format",value:function(e,t){return e.replace(/{(\w+)}/g,(function(e,n){return t[n]}))}}]),t}(r.Component);c.propTypes=i,c.defaultProps={id:"button-download-as-xls",className:"button-download",buttonText:"Download"},t.Z=c}}]);
//# sourceMappingURL=903.4a722820.chunk.js.map