"use strict";(self.webpackChunkpaymof=self.webpackChunkpaymof||[]).push([[309],{1309:function(e,n,s){s.r(n),s.d(n,{default:function(){return f}});var t=s(2982),c=s(885),o=s(2791),i=s(6871),a=s(3504),l=s(8617),r=s(7425),d=s(9153),u=s(9898),h=s(2120),j=s.n(h),x={warning:function(e){j()({title:"Warning",subtitle:"There was a problem",message:e,theme:"red",closeButton:"X",duration:6e3})},success:function(e){j()({title:"Success",subtitle:"OK!",message:e,theme:"light",closeButton:"X",backgroundTop:"green",backgroundBottom:"yellowgreen",duration:6e3})}},m=s(184),f=function(){var e=(0,o.useState)(""),n=(0,c.Z)(e,2),s=n[0],h=n[1],j=(0,o.useState)(""),f=(0,c.Z)(j,2),g=f[0],p=f[1],N=(0,o.useState)(!1),v=(0,c.Z)(N,2),L=v[0],b=v[1],y=(0,o.useState)(""),O=(0,c.Z)(y,1)[0],k=(0,o.useState)(!0),z=(0,c.Z)(k,2),S=z[0],C=z[1],_=(0,o.useState)([]),w=(0,c.Z)(_,2),E=w[0],T=w[1],Z=(0,o.useRef)(0),B=(0,i.s0)(),U=(0,u.ZP)(O),I=(0,o.useRef)(null),R=(0,o.useState)(""),F=(0,c.Z)(R,2),P=F[0],V=F[1],X=(0,i.TH)(),A=X.pathname.split("/");try{s&&(""!==A[A.length-1]?document.title="".concat(A[A.length-1][0].toUpperCase()).concat(A[A.length-1].substring(1)," | ").concat(s.toUpperCase()):document.title="Dashboard | ".concat(s.toUpperCase()))}catch(W){console.log(W)}(0,o.useEffect)((function(){S?1===Z.current&&(!I.current.classList.contains("connected")&&I.current.classList.add("connected"),I.current.classList.contains("disconnected")&&I.current.classList.remove("disconnected"),document.getElementById("conn").innerText="Back online",setTimeout((function(){return I.current.classList.remove("connected")}),3e3)):(!I.current.classList.contains("disconnected")&&I.current.classList.add("disconnected"),I.current.classList.contains("connected")&&I.current.classList.remove("connected"),document.getElementById("conn").innerText="Connection lost")}),[S]),(0,o.useEffect)((function(){return U.on("connect",(function(){console.log("connected"),C(!0),s&&U.emit("get-notification",{loggedSchool:s})})),U.on("notification",(function(e){e[0].count>0?e[0].count>100?V("99+"):V(e[0].count):V("")})),U.on("connect_failed",(function(){console.log("failed"),C(!1)})),U.on("connect_error",(function(){console.log("error"),console.clear(),C(!1)})),U.on("disconnect",(function(){console.log("disconnected"),Z.current=1,C(!1)})),U.on("show_notification",(function(e){e&&T([].concat((0,t.Z)(E),[e]))})),function(){U.off("connection"),U.off("disconnect"),U.off("get-notification"),U.close()}}),[U,s,P,E]),(0,o.useEffect)((function(){var e=setInterval((function(){if(0===E.length)clearInterval(e);else{console.log(E);var n=Array.from(E);n.pop(),T(n)}}),6500);return function(){clearInterval(e)}}),[E]),(0,o.useEffect)((function(){fetch("".concat(O,"/main"),{credentials:"include",headers:{"Content-Type":"application/json"},method:"GET"}).then((function(e){return e.json()})).then((function(e){if(e.creds){if(e.creds.school&&(p(e.creds.user),h(e.creds.school),b(e.creds.admin),!1===e.creds.admin)){var n=X.pathname.split("/");""===n[n.length-1]&&n.pop(),["users","settings"].includes(n[n.length-1])&&B("../../authorization")}}else B("../authentication")})).catch((function(e){console.log(e),B("../login")}))}),[document.readyState]),(0,o.useEffect)((function(){if(s){var e=X.pathname.split("/"),n=[];e.forEach((function(e){e!==s.replace(/ /g,"_")||n.push(e)})),n[0]!==s.replace(/ /g,"_")&&B("not-found")}}));var D=function(){window.confirm("do you want to logout?")&&fetch("".concat(O,"/logout"),{credentials:"include",headers:{"Content-Type":"application/json"},method:"GET"}).then((function(e){return e.json()})).then((function(e){e.status&&e.logout&&B("../login")})).catch((function(e){return console.log(e)}))};return(0,m.jsx)("div",{className:"home",children:(0,m.jsxs)(l.T.Provider,{value:{loggedSchool:s,loggedUser:g,admin:L,url:O,notifications:x,io:U,setNotiNum:V},children:[(0,m.jsxs)("div",{className:"connection-container",ref:I,children:[S?(0,m.jsx)(r.$Z5,{size:17}):(0,m.jsx)(r.Yh4,{size:17})," ",(0,m.jsx)("span",{id:"conn"})," "]}),E.length>0&&(0,m.jsx)("div",{className:"noti-cont",children:E.length>0&&E.map((function(e,n){return(0,m.jsxs)("div",{className:"noti-container",children:[(0,m.jsxs)("div",{className:"close",onClick:function(){return n=e.id,void T(E.filter((function(e){return e.id!==n})));var n},children:[(0,m.jsx)(r.tgW,{fill:"red"})," "]}),(0,m.jsxs)("div",{className:"title",children:[(0,m.jsx)(r.oix,{})," Notification"]}),(0,m.jsxs)("div",{className:"notification-body",children:[e.message,(0,m.jsx)("p",{children:"Now"})]})]},2*Math.random())}))}),(0,m.jsxs)("div",{className:"vert__nav",children:[(0,m.jsxs)("div",{className:"slogan",children:[(0,m.jsx)(r.yVr,{size:40,title:g+" logged in"}),(0,m.jsx)("p",{children:"Admin Fee Record"})]}),(0,m.jsxs)("nav",{children:[(0,m.jsxs)(a.OL,{to:"dashboard",className:X.pathname==="/"+s.replace(/ /g,"_")+"/"&&"active",children:[" ",(0,m.jsx)(r.gyC,{})," ",(0,m.jsx)("span",{children:"Dashboard"})]}),(0,m.jsxs)(a.OL,{to:"students",children:[" ",(0,m.jsx)(r.ruV,{})," ",(0,m.jsx)("span",{children:" Students"})]}),(0,m.jsxs)(a.OL,{to:"payment",children:[" ",(0,m.jsx)(r.CDL,{})," ",(0,m.jsx)("span",{children:"Make Payment"})]}),(0,m.jsxs)(a.OL,{to:"fees",children:[" ",(0,m.jsx)(r.BkP,{})," ",(0,m.jsx)("span",{children:"Fees"})]}),(0,m.jsxs)(a.OL,{to:"records",children:[" ",(0,m.jsx)(r.gR8,{})," ",(0,m.jsx)("span",{children:"Record"})]}),L&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(a.OL,{to:"users",className:"admin",children:[" ",(0,m.jsx)(r.jus,{})," ",(0,m.jsx)("span",{children:"Users"})]}),(0,m.jsxs)(a.OL,{to:"settings",className:"admin",children:[" ",(0,m.jsx)(r.BUe,{})," ",(0,m.jsx)("span",{children:"Settings"})]}),(0,m.jsxs)(a.OL,{to:"backup",className:"admin",children:[" ",(0,m.jsx)(r.z_I,{})," ",(0,m.jsx)("span",{children:"Backup"})]})]}),(0,m.jsxs)(a.OL,{to:"notifications",className:"",children:[" ",(0,m.jsx)(r.SnU,{})," ",(0,m.jsx)("span",{children:"Notifications"})," ",""!==P&&(0,m.jsx)("span",{className:"badge ",style:{background:"#dc3545",marginLeft:"5px"},children:P})]}),(0,m.jsxs)("button",{className:"desktop",onClick:function(){return D()},children:[" ",(0,m.jsx)(r.Vac,{})," ",(0,m.jsx)("span",{children:"Logout"})]})]})]}),(0,m.jsxs)("header",{children:[(0,m.jsx)("h4",{className:"school-name",children:s}),(0,m.jsx)("button",{onClick:function(){return D()},className:"phone",children:(0,m.jsx)(r.Vac,{style:{marginLeft:".3rem"},size:21})}),(0,m.jsxs)("div",{className:"user",title:g+" logged in",children:[(0,m.jsx)(r.Xn2,{size:21}),(0,m.jsx)("small",{children:g})]})]}),(0,m.jsx)("div",{className:"hor-nav",children:(0,m.jsxs)("nav",{children:[(0,m.jsxs)(a.OL,{to:"dashboard",className:X.pathname==="/"+s.replace(/ /g,"_")+"/"&&"active".concat(" noselect"),children:[" ",(0,m.jsx)(r.Ez2,{size:20})," "]}),(0,m.jsxs)(a.OL,{to:"students",className:"noselect",children:[" ",(0,m.jsx)(r.oNL,{size:20})," "]}),(0,m.jsxs)(a.OL,{to:"payment",className:"noselect",children:[" ",(0,m.jsx)(r.i93,{size:20})]}),(0,m.jsxs)(a.OL,{to:"fees",className:"noselect",children:[" ",(0,m.jsx)(r.F7l,{size:20})," "]}),(0,m.jsxs)(a.OL,{to:"records",className:"noselect",children:[" ",(0,m.jsx)(r.X_W,{size:20})]}),L&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(a.OL,{to:"users",className:"admin noselect",children:[" ",(0,m.jsx)(r.zOC,{size:20})," "]}),(0,m.jsxs)(a.OL,{to:"settings",className:"admin noselect",children:[" ",(0,m.jsx)(r.$Rt,{size:20})," "]}),(0,m.jsxs)(a.OL,{to:"backup",className:"admin noselect",children:[" ",(0,m.jsx)(r.dg2,{size:20})," "]})]}),(0,m.jsxs)(a.OL,{to:"notifications",className:"noselect",children:[" ",(0,m.jsx)(r.w__,{size:20})," ",""!==P&&(0,m.jsx)("span",{className:"badge ",style:{background:"#dc3545",marginLeft:"5px"},children:P})]})]})}),(0,m.jsx)("main",{className:"content",children:(0,m.jsx)(o.Suspense,{fallback:(0,m.jsx)(d.Z.AudioLoader,{}),children:(0,m.jsx)(i.j3,{})})})]})})}}}]);
//# sourceMappingURL=309.b05ef5bd.chunk.js.map