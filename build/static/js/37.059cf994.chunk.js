"use strict";(self.webpackChunkpaymof=self.webpackChunkpaymof||[]).push([[37],{2037:function(e,t,n){n.r(t),n.d(t,{default:function(){return d}});var a=n(885),s=n(2791),l=n(2185),r=n(8617),i=n(2120),c=n(7425),o=n(184),d=function(){var e=new Date,t=[e.getDate()<10?"0".concat(e.getDate()):e.getDate(),e.getUTCMonth()+1<10?"0".concat(e.getUTCMonth()+1):e.getUTCMonth()+1,e.getUTCFullYear()],n=(0,s.useState)(""),d=(0,a.Z)(n,2),u=d[0],h=d[1],m=(0,s.useState)(""),p=(0,a.Z)(m,2),f=p[0],x=p[1],j=(0,s.useState)(""),y=(0,a.Z)(j,2),g=y[0],v=y[1],b=(0,s.useState)(""),C=(0,a.Z)(b,2),S=C[0],N=C[1],w=(0,s.useState)([]),Z=(0,a.Z)(w,2),k=Z[0],L=Z[1],T=(0,s.useState)([]),F=(0,a.Z)(T,2),D=F[0],U=F[1],_=(0,s.useState)([]),E=(0,a.Z)(_,2),I=E[0],M=E[1],P=(0,s.useState)([]),O=(0,a.Z)(P,2),B=O[0],A=O[1],q=(0,s.useState)(!1),J=(0,a.Z)(q,2),G=J[0],R=J[1],Y=(0,s.useState)(0),K=(0,a.Z)(Y,2),Q=K[0],W=K[1],z=(0,s.useState)([]),H=(0,a.Z)(z,2),V=H[0],X=H[1],$=(0,s.useState)(""),ee=(0,a.Z)($,2),te=ee[0],ne=ee[1],ae=(0,s.useState)(""),se=(0,a.Z)(ae,2),le=se[0],re=se[1],ie=(0,s.useState)([]),ce=(0,a.Z)(ie,2),oe=ce[0],de=ce[1],ue=(0,s.useState)(""),he=(0,a.Z)(ue,2),me=he[0],pe=he[1],fe=(0,s.useState)(""),xe=(0,a.Z)(fe,2),je=xe[0],ye=xe[1],ge=(0,s.useState)(0),ve=(0,a.Z)(ge,2),be=ve[0],Ce=ve[1],Se=(0,s.useState)(""),Ne=(0,a.Z)(Se,2),we=Ne[0],Ze=Ne[1],ke=(0,s.useState)(""),Le=(0,a.Z)(ke,2),Te=Le[0],Fe=Le[1],De=(0,s.useState)(""),Ue=(0,a.Z)(De,2),_e=Ue[0],Ee=Ue[1],Ie=(0,s.useState)(t.join("/")),Me=(0,a.Z)(Ie,1)[0],Pe=(0,s.useState)(""),Oe=(0,a.Z)(Pe,2),Be=Oe[0],Ae=Oe[1],qe=(0,s.useState)(""),Je=(0,a.Z)(qe,2),Ge=Je[0],Re=Je[1],Ye=(0,s.useState)(0),Ke=(0,a.Z)(Ye,2),Qe=Ke[0],We=Ke[1],ze=(0,s.useState)(""),He=(0,a.Z)(ze,2),Ve=He[0],Xe=He[1],$e=(0,s.useState)(""),et=(0,a.Z)($e,2),tt=et[0],nt=et[1],at=(0,s.useState)(""),st=(0,a.Z)(at,2),lt=st[0],rt=st[1],it=(0,s.useState)(!1),ct=(0,a.Z)(it,2),ot=ct[0],dt=ct[1],ut=[],ht=(0,s.useState)([]),mt=(0,a.Z)(ht,2),pt=mt[0],ft=mt[1],xt=(0,s.useState)([]),jt=(0,a.Z)(xt,2),yt=jt[0],gt=jt[1],vt=(0,s.useState)(0),bt=(0,a.Z)(vt,2),Ct=bt[0],St=bt[1],Nt=(0,s.useState)(1),wt=(0,a.Z)(Nt,2),Zt=wt[0],kt=wt[1],Lt=(0,s.useRef)(),Tt=(0,s.useContext)(r.T),Ft=Tt.url,Dt=Tt.loggedUser,Ut=Tt.notifications,_t=Tt.io,Et=function(){R(!0),fetch("".concat(Ft,"/main/fees/records?page=").concat(Zt,"&limit=").concat(8),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(R(!1),e.status)try{ft(e.message),St(Math.ceil(e.total/8))}catch(t){Ut.warning("Failed to set datas")}else Ut.warning(e.message)})).catch((function(e){R(!1),console.log(e)}))};(0,s.useEffect)((function(){Et()}),[Zt]),(0,s.useEffect)((function(){fetch("".concat(Ft,"/main/payment/classes"),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(e.status){var t;t=e.message[0];try{A(t.terms.split(",")),U(t.sessions.split(",")),L(JSON.parse(t.classes)),X(t.payment_for.split(",")),de(t.payment_method.split(","))}catch(n){console.log("failed to set datas")}}})).catch((function(e){return console.log(e)}))}),[document.readyState]);var It=function(e){kt(e),fetch("".concat(Ft,"/main/fees/records?page=").concat(Zt,"&limit=").concat(8),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then((function(e){return e.json()})).then((function(e){if(R(!1),e.status)try{ft(e.message)}catch(t){console.log("failed to set datas")}else Ut.warning(e.message)})).catch((function(e){R(!1),console.log(e)}))},Mt=function(){pe(""),ye(""),Ce(""),nt(""),Fe(""),Ee(""),Xe(""),We(0),ne(""),re(""),Ae(""),Ze(""),Re("")};return(0,s.useEffect)((function(){var e=function(e){Lt.current&&(Lt.current.contains(e.target)||M([]))};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[Lt]),(0,o.jsxs)("div",{className:"__fees",children:[(0,o.jsx)(i.Notifications,{position:"top-right"}),(0,o.jsx)("h2",{children:"Balance Fee"}),(0,o.jsxs)("form",{className:"search-container",children:[(0,o.jsx)("label",{htmlFor:"name",children:"Name"}),(0,o.jsxs)("div",{className:"input-filter-cont",children:[(0,o.jsx)("input",{type:"select",id:"name",value:u,onKeyUp:function(){return W(0),void(u.length>1?(""!==f&&ut.push({class:f}),""!==g&&ut.push({session:g}),""!==S&&ut.push({term:S}),ut.length>0?fetch("".concat(Ft,"/main/fees/find-name"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:u,condition:!0,filterArray:ut}),credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.status&&M(e.message)})).catch((function(e){return console.log(e)})):fetch("".concat(Ft,"/main/fees/find-name"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:u,condition:!1}),credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.status&&M(e.message)})).catch((function(e){return console.log(e)}))):M([]))},onChange:function(e){return h(e.target.value)},autoComplete:"off",placeholder:"Enter Name to search"}),(0,o.jsx)("div",{className:"output-container",id:"form-id",ref:Lt,children:(0,o.jsx)("div",{className:"output-names",children:I&&I.map((function(e){return(0,o.jsxs)("div",{className:"names",onClick:function(){return function(e){var t=I.find((function(t){return t.payment_id===e}));h(t.name.toUpperCase()),M([]),W(e)}(null===e||void 0===e?void 0:e.payment_id)},children:[(0,o.jsx)("span",{children:null===e||void 0===e?void 0:e.name})," ",(0,o.jsx)("span",{children:null===e||void 0===e?void 0:e.class})]},null===e||void 0===e?void 0:e.keyid)}))})})]}),(0,o.jsxs)("select",{value:f,onChange:function(e){return function(e){throw x(e.target.value),""!==e.target.value?document.querySelector(".filter-class").classList.add("filter"):document.querySelector(".filter-class").classList.remove("filter"),new Error}(e)},className:"filter-class",children:[(0,o.jsx)("option",{value:"",children:"Class"}),k&&k.map((function(e){return(0,o.jsx)("option",{value:e.toUpperCase(),children:e.toUpperCase()},Math.random())}))]}),(0,o.jsxs)("select",{value:S,onChange:function(e){return function(e){N(e.target.value),""!==e.target.value?document.querySelector(".filter-term").classList.add("filter"):document.querySelector(".filter-term").classList.remove("filter")}(e)},className:"filter-term",children:[(0,o.jsx)("option",{value:"",children:"Term"}),B&&B.map((function(e){return(0,o.jsx)("option",{value:e.toUpperCase(),children:e.toUpperCase()},Math.random())}))]}),(0,o.jsxs)("select",{value:g,onChange:function(e){return function(e){v(e.target.value),""!==e.target.value?document.querySelector(".filter-sess").classList.add("filter"):document.querySelector(".filter-sess").classList.remove("filter")}(e)},className:"filter-sess",children:[(0,o.jsx)("option",{value:"",children:"Session"}),D&&D.map((function(e){return(0,o.jsx)("option",{value:e.toUpperCase(),children:e.toUpperCase()},Math.random())}))]}),(0,o.jsxs)("div",{className:"btn-cont",children:[(0,o.jsxs)("button",{onClick:function(e){return function(e){e.preventDefault(),M([]),x(""),v(""),N(""),document.querySelector(".filter-class").classList.add("filter");var t=!1;t=Q>0;var n={searchId:Q,name:u.trim().toLowerCase(),status:t};Q||u?fetch("".concat(Ft,"/main/fees/findId"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.status&&ft((function(t){return e.message}))})).catch((function(e){return console.log(e)})):Ut.warning("Empty search")}(e)},className:"btn btn-success btn-sm",children:[" ",(0,o.jsx)(c.Qcu,{}),(0,o.jsx)("span",{style:{marginLeft:".3rem"},children:"Find"})]}),(0,o.jsx)("button",{onClick:function(e){return function(e){e.preventDefault(),h(""),M([]),x(""),document.querySelector(".filter-class").classList.add("filter"),Et()}(e)},className:"btn btn-danger btn-sm",children:"Clear"})]})]}),(0,o.jsxs)("div",{className:"balance-table",children:[(0,o.jsx)("div",{className:"refresh",style:{display:"flex",justifyContent:"flex-end",margin:".2rem 0"},children:(0,o.jsx)("span",{style:{cursor:"pointer"},onClick:function(){return Et()},title:"Refresh",children:(0,o.jsx)(c.PwW,{})})}),(0,o.jsxs)("table",{border:1,className:"table table-responsive table-bordered",children:[(0,o.jsx)("thead",{className:"thead-dark",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"Name"}),(0,o.jsx)("th",{children:"payment id"}),(0,o.jsx)("th",{children:"Class"}),(0,o.jsx)("th",{children:"Balance (\u20a6)"}),(0,o.jsx)("th",{children:"Action"})]})}),(0,o.jsx)("tbody",{children:G?(0,o.jsx)("tr",{className:"loading",children:(0,o.jsx)("td",{colSpan:5,style:{textAlign:"center"},children:"loading..."})}):0===pt.length?(0,o.jsx)("tr",{className:"loading",children:(0,o.jsx)("td",{colSpan:5,style:{textAlign:"center"},children:"No records available"})}):pt.map((function(e,t){return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:e.name}),(0,o.jsxs)("td",{children:[e.payment_id," "]}),(0,o.jsxs)("td",{children:[e.class," "]}),(0,o.jsxs)("td",{children:[parseInt(e.balance).toLocaleString()," "]}),(0,o.jsx)("td",{children:(0,o.jsx)("div",{className:"action-cont",children:(0,o.jsx)("div",{onClick:function(){return function(e){Mt();var t=pt.find((function(t){return t.keyid===e}));pe(t.name.toUpperCase()),rt(t.class.toUpperCase()),ye(t.payment_id),Ce(parseInt(t.expected_payment)),nt(parseInt(t.balance)),Fe(t.term),Ee(t.session),Xe(t.keyid),document.getElementsByClassName("fee-modal")[0].classList.add("show-modal"),document.body.style.overflow="hidden",window.scrollTo(0,-1*parseInt(window.scrollY||"0"))}(e.keyid)},className:"btn btn-outline-primary btn-sm",children:"balance Fee"})})})]},e.keyid+new Date+Math.random())}))})]}),pt.length>0&&(0,o.jsxs)("div",{className:"pagination-buttons",children:[(0,o.jsx)("button",{onClick:function(){return It(1)},disabled:1===Zt,className:"first-page",children:"First"}),(0,o.jsx)("button",{onClick:function(){return It(Zt-1)},disabled:1===Zt,className:"prev-page",children:"Prev"}),Array.from(Array(Ct).keys()).map((function(e){return e<=7?(0,o.jsx)("button",{onClick:function(){return It(e+1)},className:Zt-1===e?"active":"",children:e+1},e+1):""})),(0,o.jsx)("button",{onClick:function(){return It(Zt+1)},disabled:Zt===Ct,className:"next-page",children:"Next"}),(0,o.jsx)("button",{onClick:function(){return It(Ct)},disabled:Zt===Ct,className:"last-page",children:"Last"})]})]}),(0,o.jsx)(l.Z,{title:"Balance Fee",classModal:"fee-modal",save:function(){""===te||""===le||""===Qe||""===e?Ut.warning("Fill in all fields"):(""===we&&Ze(te),yt.length>0?Ut.warning(yt[0]):fetch("".concat(Ft,"/main/fees/save"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:me.toLowerCase(),payment_id:je,amount_paid:Qe,expected_payment:be,balance:tt-Qe,term:Te.toLowerCase(),session:_e,DOG:Me,DOP:Be,balanceClass:lt,balance_date:Ge,remark:we?we.toLowerCase():te.toLowerCase(),keyid:Ve,payment_for:te.toLowerCase(),payment_method:le.toLowerCase(),accountant:Dt.toLowerCase()})}).then((function(e){return e.json()})).then((function(e){e.status?(Ut.success(e.message),Et(),_t.emit("display_notification",{type:parseInt(tt)-parseInt(Qe)===0?"cleared":"part",name:me.toLowerCase(),payment_id:je,amount_paid:Qe}),document.getElementsByClassName("fee-modal")[0].classList.remove("show-modal"),document.body.style.overflow="auto",document.body.style.top="",Mt()):Ut.warning(e.message)})).catch((function(e){console.log(e)})))},children:(0,o.jsxs)("form",{action:"",children:[(0,o.jsxs)("div",{className:"input-cont",children:[(0,o.jsx)("label",{htmlFor:"balance-user",children:"Name"}),(0,o.jsx)("input",{type:"text",value:me,disabled:!0,id:"balance-user"})]}),(0,o.jsxs)("div",{className:"input-cont",children:[(0,o.jsx)("label",{htmlFor:"payment-id",children:"Payment ID"}),(0,o.jsx)("input",{type:"text",value:je,disabled:!0,id:"payment-id"})]}),(0,o.jsxs)("div",{className:"input-cont",children:[(0,o.jsx)("label",{htmlFor:"class",children:"Class"}),(0,o.jsx)("input",{type:"text",value:lt,disabled:!0,id:"class"})]}),(0,o.jsxs)("div",{className:"input-cont",children:[(0,o.jsx)("label",{htmlFor:"total",children:"Total"}),(0,o.jsx)("input",{type:"text",value:be.toLocaleString(),disabled:!0,id:"total"})]}),(0,o.jsxs)("div",{className:"input-cont",children:[(0,o.jsx)("label",{htmlFor:"balance-payment",children:"Balance"}),(0,o.jsx)("input",{type:"text",value:tt.toLocaleString(),onChange:function(e){return nt(e.target.value)},disabled:!0,id:"balance-payment"})]}),(0,o.jsxs)("div",{className:"input-cont",children:[(0,o.jsx)("label",{htmlFor:"payment-type",children:"Payment Type"}),(0,o.jsxs)("select",{value:te,onChange:function(e){return ne(e.target.value)},className:"payment-for",id:"payment-type",children:[(0,o.jsx)("option",{value:"",children:"Select Payment Type"}),V&&V.map((function(e){return(0,o.jsx)("option",{value:e.toUpperCase(),children:e.toUpperCase()},Math.random())}))]})]}),(0,o.jsxs)("div",{className:"input-cont",children:[(0,o.jsx)("label",{htmlFor:"payment-method",children:"Payment Method"}),(0,o.jsxs)("select",{value:le,onChange:function(e){return re(e.target.value)},className:"payment-method",id:"payment-method",children:[(0,o.jsx)("option",{value:"",children:"Select Payment Method"}),oe&&oe.map((function(e){return(0,o.jsx)("option",{value:e.toUpperCase(),children:e.toUpperCase()},Math.random())}))]})]}),(0,o.jsxs)("div",{className:"input-cont",children:[(0,o.jsx)("label",{htmlFor:"advance",children:"Advance"}),(0,o.jsx)("input",{type:"number",value:Qe,onChange:function(e){return function(e){We(e.target.value),parseInt(e.target.value)>parseInt(tt)?(e.target.style.border="1px solid red",Ut.warning("Advance is greater than balance"),gt(["advance is greater than balance"])):(e.target.style.border="1px solid gainsboro",gt([]))}(e)},onDoubleClick:function(){tt&&We(tt)},id:"advance",placeholder:"Enter Advance",onBlur:function(){Qe>0?(0===yt.length&&parseInt(tt)-parseInt(Qe)>0&&dt(!0),0===yt.length&&parseInt(tt)-parseInt(Qe)===0&&dt(!1)):dt(!1)}})]}),ot&&(0,o.jsxs)("div",{className:"input-cont",children:[(0,o.jsx)("label",{htmlFor:"dob",children:"Date of Balance"}),(0,o.jsx)("input",{type:"date",value:Ge,onChange:function(e){return function(e){new Date(e.target.value)<new Date(Date.now())?(Ut.warning("Balance Date is should be in the future"),e.target.style.border="1px solid red"):(e.target.style.border="1px solid gray",Re(e.target.value))}(e)},id:"dob",placeholder:"Date of Balance"})]}),(0,o.jsxs)("div",{className:"input-cont",children:[(0,o.jsx)("label",{htmlFor:"date",children:"Date"}),(0,o.jsx)("input",{type:"date",value:Be,onChange:function(e){return Ae(e.target.value)},id:"date",placeholder:"Date of payment"})]}),(0,o.jsxs)("div",{className:"input-cont",children:[(0,o.jsx)("label",{htmlFor:"remark",children:"Remark"}),(0,o.jsx)("textarea",{id:"remark",value:we,onChange:function(e){return Ze(e.target.value)},placeholder:"Enter Remark"})]})]})})]})}}}]);
//# sourceMappingURL=37.059cf994.chunk.js.map